<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - ØµØ§Ù„ÙˆÙ† Ù„Ù…Ø³Ø© Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©</title>

<style>
body {
    font-family:'Cairo',sans-serif;
    background: linear-gradient(180deg,#000,#111);
    color:#fff;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    min-height:100vh;
    margin:0;
    padding:40px 0;
}

header { text-align:center; margin-bottom:20px; }

header .logo-container {
    display:inline-block;
    border:4px solid gold;
    border-radius:50%;
    padding:5px;
    box-shadow:0 0 20px gold;
    margin-bottom:10px;
}

header .logo-container img {
    width:100px; height:100px;
    border-radius:50%; object-fit:cover;
}

header h1 {
    font-size:2rem;
    color:gold;
    margin:0;
    text-shadow:0 0 10px gold;
}

.button-top {
    display:flex;
    justify-content:center;
    gap:10px;
    margin-bottom:20px;
    flex-wrap:wrap;
}

.button-top button {
    width:160px;
    height:50px;
    border:none;
    border-radius:8px;
    font-weight:bold;
    font-size:1rem;
    cursor:pointer;
    transition: 0.3s;
}

.button-top button:hover {
    transform: translateY(-2px);
    box-shadow: 0 0 15px gold;
}

.view-btn { background-color:#44bd32; color:white; }
.logout-btn { background-color:red; color:white; }

.sales-box {
    background:#111;
    padding:30px 25px;
    border-radius:15px;
    box-shadow:0 0 35px rgba(255,215,0,0.5);
    width:400px;
    max-width:90%;
    text-align:center;
    display:flex;
    flex-direction:column;
    align-items:center;
}

.sales-box:hover { box-shadow:0 0 50px rgba(255,215,0,0.8); }

h2 {
    color:gold;
    margin-bottom:20px;
    text-shadow:0 0 10px gold;
    font-size:1.5rem;
}

.input-row {
    display: flex;
    gap:10px;
    width:100%;
    margin:15px 0;
}

.input-row input,
.input-row button {
    flex:1;
    height:60px;
    border-radius:8px;
    border:none;
    font-size:1rem;
    font-weight:bold;
    text-align:center;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    position: relative;
    transition: all 0.2s ease;
}

.input-row input { background:#222; color:#fff; }
.cash-btn { background:#2ecc71; color:#fff; }
.card-btn { background:#3498db; color:#fff; }

.input-row button:hover { transform: translateY(-3px); box-shadow: 0 8px 20px gold; }
.input-row button:active { transform: translateY(1px); box-shadow: 0 3px 6px #00000066; }

.input-row button .icon-fly {
    position: absolute;
    top:50%;
    left:50%;
    transform: translate(-50%, -50%);
    opacity:0;
    font-size:20px;
    pointer-events:none;
    animation: fly 0.6s ease forwards;
}

@keyframes fly {
    0% { transform: translate(-50%, -50%) scale(1); opacity:1; }
    50% { transform: translate(-50%, -100%) scale(1.5); opacity:1; }
    100% { transform: translate(-50%, -150%) scale(0.5); opacity:0; }
}

@media(max-width:480px){
    .input-row input, .input-row button { height:50px; font-size:0.95rem; }
}
</style>
</head>

<body>
<div style="display:flex; flex-direction:column; align-items:center; width:100%;">

<header>
    <div class="logo-container"><img src="logo.jpg" alt="Logo"></div>
    <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h1>
</header>

<div class="button-top">
    <button class="view-btn" onclick="goToSalesList()">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
    <button class="logout-btn" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
</div>

<div class="sales-box">
    <h2 id="employeeName">Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ [Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù]</h2>
    <div class="input-row">
        <input type="number" id="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
        <button class="cash-btn" onclick="pay('cash')">ğŸ’µ ÙƒØ§Ø´</button>
        <button class="card-btn" onclick="pay('card')">ğŸ’³ Ø´Ø¨ÙƒØ©</button>
    </div>
</div>

</div>

<script>
// ** Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù **
function getEmployeeName(){
    const params = new URLSearchParams(window.location.search);
    return params.get('user') || localStorage.getItem('loggedEmployee') || 'Ø§Ù„Ù…ÙˆØ¸Ù';
}

let employeeName = getEmployeeName();
document.getElementById('employeeName').textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ ${employeeName}`;
localStorage.setItem('loggedEmployee', employeeName);

if(!window.location.search.includes('user=')){
    const newUrl = window.location.pathname + '?user=' + encodeURIComponent(employeeName);
    window.history.replaceState({}, '', newUrl);
}

// ** Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ø¥Ù„Ù‰ AM/PM **
function formatTime(){
    const now = new Date();
    let hours = now.getHours();
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const ampm = hours >= 12 ? "PM" : "AM";
    hours = hours % 12 || 12;
    return `${hours}:${minutes} ${ampm}`;
}

// ** Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª **
function pay(method){
    const amt = parseFloat(document.getElementById('amount').value);
    if(!amt){ alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº'); return; }

    const now = new Date();

    let salesData = JSON.parse(localStorage.getItem('salesData') || '[]');
    salesData.push({
        employee: employeeName,
        amount: amt,
        method: method,
        date: now.toISOString().slice(0, 10), // YYYY-MM-DD
        time: formatTime() // 12 Hour format
    });

    localStorage.setItem('salesData', JSON.stringify(salesData));

    // Ø­Ø±ÙƒØ© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©
    const button = method==='cash' ? document.querySelector('.cash-btn') : document.querySelector('.card-btn');
    const icon = document.createElement('span');
    icon.classList.add('icon-fly');
    icon.textContent = method==='cash' ? 'ğŸ’µ' : 'ğŸ’³';
    button.appendChild(icon);
    setTimeout(()=> icon.remove(), 600);

    alert(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© ${method.toUpperCase()} Ø¨Ù‚ÙŠÙ…Ø© ${amt}`);
    document.getElementById('amount').value='';
}

function goToSalesList(){
    window.location.href = 'employee_sales_list.html?user=' + encodeURIComponent(employeeName);
}

function logout(){
    localStorage.removeItem('loggedEmployee');
    window.location.href = 'index.html';
}
</script>

</body>
</html>
